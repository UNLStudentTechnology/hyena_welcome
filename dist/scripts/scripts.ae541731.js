"use strict";angular.module("hyenaWelcomeApp",["ngAnimate","ngCookies","ngResource","ngSanitize","ngTouch","ui.router","hyenaAngular"]).config(["$stateProvider","$urlRouterProvider","$locationProvider",function(a,b,c){a.state("unl-layout",{templateUrl:"views/layouts/unl-layout.html",data:{requireAuth:!0}}).state("unl-layout-fullscreen",{templateUrl:"views/layouts/unl-layout-fullscreen.html",data:{requireAuth:!1}}).state("unl-layout-kiosk",{templateUrl:"views/layouts/unl-layout-kiosk.html",data:{requireAuth:!1}}).state("unl-layout-kiosk.kiosk",{url:"/:groupId/kiosk",templateUrl:"views/kiosk.html",controller:"KioskCtrl"}).state("unl-layout-kiosk.kiosk.people",{url:"/people",templateUrl:"views/kiosk/people.html"}).state("unl-layout-kiosk.kiosk.calendar",{url:"/calendar",templateUrl:"views/kiosk/calendar.html"}).state("unl-layout-kiosk.kiosk.signin",{url:"/signin",templateUrl:"views/kiosk/signin.html"}).state("unl-layout-kiosk.kiosk.message",{url:"/message",templateUrl:"views/kiosk/message.html"}).state("unl-layout.new_location",{url:"/:groupId/location/new",templateUrl:"views/new_location.html",controller:"NewLocationCtrl"}).state("unl-layout.location",{url:"/:groupId/location/:locationId",templateUrl:"views/location.html",controller:"LocationCtrl"}).state("unl-layout.main",{url:"/:groupId",templateUrl:"views/main.html",controller:"MainCtrl"}).state("unl-layout.new",{url:"/:groupId/board/new",templateUrl:"views/new.html",controller:"NewCtrl"}),b.otherwise("/"),c.html5Mode(!0)}]).config(["$httpProvider",function(a){a.interceptors.push(["$injector",function(a){return a.get("AuthInterceptor")}])}]).constant("FBURL","https://hyena-welcome.firebaseio.com/").constant("APIKEY","OTA2MmRmMDlmZGFmNWY1MTcwMmVhZDVk").constant("APIPATH","http://st-studio.unl.edu/hyena_platform/public/api/1.0/").constant("PLATFORM_ROOT","http://st-studio.unl.edu/hyena_platform/public/").constant("AUTH_SCOPE","groups"),angular.module("hyenaWelcomeApp").controller("MainCtrl",["$scope","$rootScope","$stateParams","FirebaseGroupService","LocationService",function(a,b,c,d,e){var f=c.groupId;a.groupId=b.currentGroupId=f,angular.isDefined(f)&&""!==f&&d.existsOrAdd(f),f&&(a.locations=e.groupLocations(f,10).$asArray())}]),angular.module("hyenaWelcomeApp").controller("KioskCtrl",["$scope","$stateParams","$rootScope","$location","LocationService","GroupService","UserService","Notification",function(a,b,c,d,e,f,g,h){a.selectedUser=null,a.loadingContent=!1,a.authUser=null;var i=b.groupId;a.groupId=c.currentGroupId=i,(angular.isUndefined(a.selectedUser)||null===a.selectedUser)&&d.path(i+"/kiosk/people"),f.get(i,"users").then(function(b){a.group=b.data,a.members=b.data.users},function(a){h.show("Sorry! Unable to load your group.","error")}),a.selectUser=function(b){a.selectedUser=b},a.validateAndGet=function(b){a.loadingContent=!0,g.validateAndGet(b).then(function(b){a.authUser=b},function(a){console.log(a),angular.isDefined(a.message)?h.show(a.message,"error"):h.show("Sorry! There was an error.","error")}),a.loadingContent=!1},a.sendMessage=function(){h.show("Your message was sent successfully.","success"),a.selectedUser=a.authUser=null,d.path(i+"/kiosk/people")}}]),angular.module("hyenaWelcomeApp").service("BoardService",["$firebase","$q","AppFirebase",function(a,b,c){var d=c.getRef(),e={get:function(b){return b=b.trim(),a(d.child("/boards/"+b))},groupBoards:function(b,c){c=c||20,b=parseInt(b);var e=d.child("boards").orderByChild("group_id").equalTo(b).limitToFirst(c);return a(e)},add:function(b,c){return a(d.child("boards")).$push(b).then(function(b){return a(d.child("/groups/"+c+"/boards")).$set(b.key(),!0),b})}};return e}]),angular.module("hyenaWelcomeApp").controller("NewCtrl",["$scope","$stateParams","$rootScope","BoardService","Notification",function(a,b,c,d,e){var f=b.groupId;a.groupId=c.currentGroupId=f,a.board={created_at:moment().format(),group_id:parseInt(f),title:"",active:1},a.createBoard=function(){d.add(a.board,f).then(function(b){console.log(b);var c=b.key();a.go("/"+f+"/board/"+c),e.show("Your board has been created successfully!","success")},function(a){console.log("Create Board Error",a),e.show("There was an error creating your board.","error")})}}]),angular.module("hyenaWelcomeApp").controller("BoardCtrl",["$scope","$stateParams","$rootScope","BoardService","Notification",function(a,b,c,d,e){var f=b.groupId;a.groupId=c.currentGroupId=f;var g=a.boardId=b.boardId,h=d.get(g).$asObject();h.$bindTo(a,"board")}]),angular.module("hyenaWelcomeApp").controller("NewLocationCtrl",["$scope","$stateParams","$rootScope","Notification","LocationService",function(a,b,c,d,e){var f=b.groupId;a.groupId=c.currentGroupId=f,a.location={created_at:moment().format(),group_id:parseInt(f),title:"",proximity_uuid:"",active:1},a.createLocation=function(){e.add(a.location,f).then(function(b){console.log(b),a.go("^.main",{groupId:f}),d.show("Your location has been created successfully!","success")},function(a){console.log("Create Location Error",a),d.show("There was an error creating your location.","error")})}}]),angular.module("hyenaWelcomeApp").service("LocationService",["$firebase","$q","AppFirebase",function(a,b,c){var d=c.getRef(),e={get:function(b){return b=b.trim(),a(d.child("/locations/"+b))},groupLocations:function(b,c){c=c||20,b=parseInt(b);var e=d.child("locations").orderByChild("group_id").equalTo(b).limitToFirst(c);return a(e)},add:function(b,c){return a(d.child("locations")).$push(b).then(function(b){return a(d.child("/groups/"+c+"/locations")).$set(b.key(),!0),b})}};return e}]),angular.module("hyenaWelcomeApp").controller("LocationCtrl",["$scope","$stateParams","$rootScope","LocationService","Notification",function(a,b,c,d,e){var f=b.groupId;a.groupId=c.currentGroupId=f;var g=a.locationId=b.locationId,h=d.get(g).$asObject();h.$bindTo(a,"location")}]);